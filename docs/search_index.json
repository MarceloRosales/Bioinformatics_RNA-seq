[["sra-download-qc-and-trimming.html", "Chapter 3 SRA Download, QC, and Trimming", " Chapter 3 SRA Download, QC, and Trimming Bioinformatics - SRA Download, QC, and Trimming. Create environment (avoid spaces or special characters). Init environment conda install sra-tools This will allow us to pull directly from the sra page. (where the sample ex. Files) Go to page. Select only files needed. Then in the Selected &gt; click on Accession List &gt; Save Drag onto the file structure, so its now in system ls to see the files (SRR_Acc_List.txt) Check ‘head SRR_Acc_List.txt’ command Also you can use the vi SRR_Acc_List.txt command to see the list in the file. Ex. ①. SRR2121770\\ ②. SRR2121771\\ ③. SRR2121774\\ ④. SRR2121778\\ ⑤. Etc. Now that we have the list of files, we have to individually download each one of them. One way to do that is with the fastq-dump --gzi --split-file SRR2121770 &amp; command. ①. This command will take the SRR2121770 file, and save it as a .gzi file (to save space) ②. it will split the file in forward (1) and Reverse (2), ③. the “&amp;” sign means that it will run this command in the background. This will take some time since the file is big. A way to see if the process is finished or not is with the command jobs, which gives a list of the jobs in process or nothing if there are not jobs running. Another way to do it is with the pipe command, so we don’t have to do this process for each file. Use the command cat SRR_Acc_List.txt | parallel fastq-dump --gzi --split-file {}. ①. This will take the SRR_Acc_List.txt and catalog the list. ②. Then it will take each of the element in the list &quot;{}&quot; slipt them, and save them as gzi. ③. In the rawReads folder???.(create rawReads folder). you will have a list of .fastq.gz_1 and .fastq.gz_2 for each element of the list. `…rawReads$ ls`. ④. Each time something is changed in the files, create a new folder and save there so the originals are not modified. Ex. Trimmed. Once all files are downloaded, install multiqc. conda install multiqc. (if not installed) Before running fastqc, create an output directory where to save the processed files. mkdir rawFastQC (make sure you are in the right directory before making this folder). Then run fastqc: fastqc -t 64 rawReads/*fastq.gz -o rawFastQC This means, process files with fastqc using 64 treads (-t 64) windows/linux virtual machine; by taking all fastqc.gz files in the folder rawReads; and save in the output directory (-o) called rawFastQC. This process will take a long time depending on the number and size of the files. Once finished cd rawFastQC and check the files ls Then inside the folder, run multiqc in multiqc. Once this finished, inside the folder a new “multiqc_report.html” will be created. Open the files and compare. 22:29 Once this quality control is finished we can pass to the trimming of the samples. Install trimmomatic, conda install trimmomatic (if not installed). If we are going to trim the files, we need to make a new folder, so exit rawFastQC folder. cd.. and mkdir trimmedReads, we are going to point trimmomatic the this folder. We are going to pull our true adapter sequences to our working directory. Then it will be a lot easier to point trimmomatic to that vs having to type in the really long path. cp ~/miniconda3/envs/name_of_environment/share/trimmomatic-0.39-1/adapters/TrueSeq3-PE-2.fa . (the last point is important, it means that the command will the done in this folder). This command copy the file TruSeq3-PE-2.fa file to our current folder, why? so the process will be done directly in our folder, instead of the need to type the path to the folder (if not, in the code, instead of the point, type the path to the directory.) cp ~/miniconda3/envs/rna-seq_test/share/trimmomatic-0.39-1/adapters/TrueSeq3-PE-2.fa . This gives error. Sometimes, due to updates in conda and trimmomatic, folder names might change or there is a space in a folders name. Check if this is the case by open \"/usr/local/anaconda3/envs/rna-seq_test/share/\". Seems like the version of timmomatic is “0.39-2” and not “0.39-1, and I installed anaconda3 and not miniconda3. Correct code and try again. Full path is: /usr/local/anaconda3/envs/rna-seq_test/share/trimmomatic-0.39-2/adapters/TruSeq3-PE-2.fa cp /usr/local/anaconda3/envs/rna-seq_test/share/trimmomatic-0.39-2/adapters/TruSeq3-PE-2.fa . Now run the trimmomatic. "]]
